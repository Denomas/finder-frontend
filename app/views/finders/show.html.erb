<% content_for :title, finder.name %>

<% if finder.beta? %>
  <% if finder.beta_message %>
    <%= render partial: 'govuk_component/beta_label', locals: { message: finder.beta_message } %>
  <% else %>
    <%= render partial: 'govuk_component/beta_label' %>
  <% end %>
<% end %>

<header>
  <div class="title-and-metadata">
    <%= render partial: 'govuk_component/title', locals: {
      title: finder.name
    } %>
    <% if finder.primary_organisation %>
      <div class="metadata">
        <%= render partial: 'govuk_component/metadata', locals: {
          from: link_to(finder.primary_organisation.title, finder.primary_organisation.web_url),
        } %>
      </div>
    <% end %>
    <% if finder.email_alert_signup_enabled? %>
      <p class='email-link'>
        <%= link_to "Subscribe to email alerts", finder.email_alert_signup_url %>
      </p>
    <% end %>
  </div>

  <% if finder.related.any? %>
    <div class='related-links'>
      <ul>
        <% finder.related.each do |link| %>
          <li><%= link_to link[:title], link[:web_url] %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
</header>

<div class="filtering">
  <%= render finder.facets %>
  <div class='js-live-search-results-block'>
    <div class="filtered-results">
      <div aria-live='assertive' id='js-search-results-info'>
        <%= render_mustache('result_count', @results.to_hash)%>
      </div>
      <div id='js-results'>
        <%= render_mustache('results', @results.to_hash) %>
      </div>
    </div>
  </div>
</div>
